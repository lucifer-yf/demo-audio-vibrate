<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>音乐振动播放器 - Audio Vibration Player</title>
    <meta name="description" content="一个支持音乐律动振动的网页音频播放器">
    <link rel="stylesheet" href="styles/main.css">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#2196F3">
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="app-header">
            <h1>🎵 音乐振动播放器</h1>
            <p class="subtitle">让音乐在你的掌心律动</p>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- File Upload Section -->
            <section class="file-section">
                <div class="upload-area" id="uploadArea">
                    <div class="upload-icon">📁</div>
                    <h3>选择音乐文件</h3>
                    <p>支持 MP3、AAC、OGG 格式</p>
                    <input type="file" id="audioFile" accept="audio/*" hidden>
                    <button class="upload-btn" onclick="document.getElementById('audioFile').click()">
                        选择文件
                    </button>
                </div>
            </section>

            <!-- Audio Player Section -->
            <section class="player-section" id="playerSection" style="display: none;">
                <div class="audio-info">
                    <div class="track-name" id="trackName">未选择文件</div>
                    <div class="track-duration" id="trackDuration">00:00 / 00:00</div>
                </div>

                <div class="audio-controls">
                    <button class="control-btn" id="playPauseBtn">
                        <span class="play-icon">▶️</span>
                    </button>
                </div>

                <div class="progress-container">
                    <div class="progress-bar" id="progressBar">
                        <div class="progress-fill" id="progressFill"></div>
                        <div class="progress-handle" id="progressHandle"></div>
                    </div>
                </div>

                <div class="volume-container">
                    <span class="volume-icon">🔊</span>
                    <input type="range" class="volume-slider" id="volumeSlider" min="0" max="100" value="50">
                </div>
            </section>

            <!-- Vibration Control Section -->
            <section class="vibration-section" id="vibrationSection" style="display: none;">
                <div class="vibration-header">
                    <h3>振动控制</h3>
                    <div class="vibration-status" id="vibrationStatus">
                        <span class="status-indicator" id="statusIndicator">⚪</span>
                        <span class="status-text" id="statusText">振动已关闭</span>
                    </div>
                </div>

                <div class="vibration-controls">
                    <label class="toggle-switch">
                        <input type="checkbox" id="vibrationToggle">
                        <span class="slider"></span>
                        <span class="toggle-label">启用振动</span>
                    </label>
                </div>

                <div class="vibration-info">
                    <div class="info-item">
                        <span class="info-label">节拍检测:</span>
                        <span class="info-value" id="beatInfo">未检测</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">音频强度:</span>
                        <span class="info-value" id="intensityInfo">0%</span>
                    </div>
                </div>
            </section>

            <!-- Visualization Section -->
            <section class="visualization-section" id="visualizationSection" style="display: none;">
                <h3>音频可视化</h3>
                <canvas id="audioCanvas" width="300" height="150"></canvas>
            </section>
        </main>

        <!-- Footer -->
        <footer class="app-footer">
            <div class="support-info">
                <p id="supportInfo">正在检测设备支持情况...</p>
            </div>
        </footer>

        <!-- Error Modal -->
        <div class="modal" id="errorModal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>⚠️ 提示</h3>
                    <button class="close-btn" onclick="closeModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <p id="errorMessage"></p>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-primary" onclick="closeModal()">确定</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Audio element (hidden) -->
    <audio id="audioElement" preload="metadata"></audio>

    <!-- Scripts -->
    <script src="js/utils.js"></script>
    <script src="js/audio-player.js"></script>
    <script src="js/audio-analyzer.js"></script>
    <script src="js/vibration-controller.js"></script>
    <script src="js/visualizer.js"></script>
    <script src="js/app.js"></script>
</body>
</html>